<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>课程列表</title>
<meta name="viewport" content="initial-scale=1, maximum-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<!--ui包-->
<link rel="stylesheet" href="../../../css/sm.css">
<link rel="stylesheet" href="../../../css/layout.css">
<style>
	.signClassTitle{line-height:1.2rem}
	.class_basic .class_info{line-height:1rem}
	.infinite-scroll-preloader {margin-top:-2rem;margin-bottom: 3rem}
</style>
</head>
<body>
	<div class="page-group" id="touch">
		<div class="page page-current" id="sign_class_list">
			<!--顶部-->
			<div class="signClassTitle bar bar-nav">
				<div style="padding-top: .3rem;" id="signTitle">2018年第二学期艺术培训招生</div>
				<div class="color-gray class-timeTip" id="timeTip">距离报名开始还有:1天3小时28分43秒</div>
				<div class="signNotice open-signNotice" style="">
					<img src="../../../images/warning.png" width="30" height="30"
						style="margin-top: -3px;" />
					<div class="signTipTitle">报名须知</div>
				</div>
			</div>
			<!--顶部 End-->
			<!-- 检索条件-->
			<div class="tool" >
				<select  id="subjects" class="select" name="">
					<option value="1">科目1</option>
				</select>
				<span class="selectbox" id="categoryId" > 
					<div class="select" style="cursor:pointer;width: 42%;">科目筛选<span id="changedCour">（0）</span></div>
				</span> 
			    <span id="toFilterTip" style="margin-left:1rem;width:64%;text-align:right;color:#8e8e8e;"> 
					已过滤年龄不符班级
				</span> 
			</div>
			<!-- 检索条件End-->
			<!--操作：报名/认证 -->
			<div class='list_bottom_tool'>
				<div class="tool_tipText" id="tool_tipText">暂未选择班级！</div>
				<div class="tool_toDo" id="tool_toDo">立即报名</div>
			</div>
			<!--操作	end-->

			<div class="content native-scroll infinite-scroll" data-distance="100" style="top:6rem">
				<div class="list-block class-list" style="margin-top: 0; margin-bottom: 3rem;">
					<ul id="allClass" class="list-container" style="border:none;">
						
						
					</ul>
				</div>
				<!-- 加载提示符 -->
				<div class="infinite-scroll-preloader">
					<div class="preloader"></div>
				</div>
			</div>
			<!--班级列表 End-->
		</div>
	</div>
	<!--须知-->
	<div class="popup popup-signNotice modal-in" id="firstTip" style="display:block;">
		<header class="bar bar-nav">
			<a class="button button-link button-nav pull-right close-popup" id="closeFirst">
				关闭 </a>
			<h1 class="title">报名须知</h1>
		</header>
		<div class="content native-scroll">
			<div class="content-inner">
				<div class="content-block">
					<div class="text" style="padding: 0px;line-height: 1.5rem" id="shouldKnow">      网上报名将于7月21日上午九点准时开始，额满为止，报名成功后请您按照系统规定的缴费时间前往少年宫报名处完成缴费工作（本次缴费支持刷卡服务）。<br> 
						（一）下学期培训时间安排：2016年9月6日（周二）至2017年1月1日（周日），共十七周，含一周备用周，遇特殊情况顺延，学期共十六次课。<br>
						（二）交费后请家长妥善保管正式机打发票，若票据丢失一律不予办理退费及转班。<br>
						（三）退费规定：开课前退费，核退全部费用；开课后前四周（含第四周）退费，按照课时核退学费，从第五周至第八周期间退费扣除一半学费，超过教学总学时1/2不再办理退费。注：由于寒、暑假班时间较短，故开课后退费直接扣除一半学费，超过教学总学时1/2不再办理退费。<br>
						（四）退费时间 <br>
						（1）2016年9月3日（周六）、4日（周日）9:00-11:30，14:00-16:00 <br>
						（2）新学期退费时间：2016年9月6日开学后在规定工作时间内可办理退费。<br>
						（五）工作时间：周二至周五：17:00-19:00（周一休息）周六、周日：8:30-12:00  14:00-19:00；网址：www.tjcp.com.cn  咨询电话：27353746</div>
				</div>
				<div class="content-block">
					<a class="button close-popup" id="first">查看课程列表</a>
				</div>
			</div>
		</div>
	</div>
	<!-- 须知 End-->

	<!--赛选数据-->
	<div class="page" id='password'>
		<header class="bar bar-nav">
			<a class="button button-link button-nav pull-left  external" id="back"> <span class="icon icon-left"></span>
				返回
			</a>
			<a class="button button-link button-nav pull-left" href="" id="clearBtn" style="padding-left:3rem">重置</a>
			<a class="button button-link button-nav pull-right close-popup"
				id="saveChanged"> 确定 </a>
		</header>
		<div class="content native-scroll" style="background: #fff;">
			<div class="allCategory pull-left list-block" id="allCategory"
				style="width:40%; height:100%;margin:0;">
				<ul style="border-bottom:0;"></ul>
			</div>
			<div class="allCourse pull-right list-block" id="allCourse"
				style="width:60%; min-height:100%;margin:0;border-left:1px #e0e0e0 dashed;">
				<ul style="border-bottom: 0;"></ul>
			</div>
		</div>
	</div>
	<!-- 赛选数据 End-->

</body>
</html>
<script src='../../../js/zepto.min.js'></script>
<script src='../../../js/sm.min.js'></script>
<script src='../../../js/config.js'></script>

<script>
	// var baseUser = JSON.parse(sessionStorage.baseUser);
	var planId = GetUrlParam("planId"),
		planData;
		subjectId;
		classWeek;
	$(function(){
		getData(domainName + '/apply/plan/info',{
			token:baseUser.token,
			org_id:baseUser.orguser.org_id,
			planId:planId
		},function(res){
			if(res.code == 200 && res.success == true){
				planData = res.data;
				$("#shouldKnow").text(planData.content);
			}else{
				$.alert(res.message);
				return false;
			}
		},null,false)
		 //无限滚动
		$(document).on("pageInit", "#sign_class_list", function (e, id, page) {
			var loading = false;
			// 每次加载添加多少条目
			var itemsPerLoad = 10;
			// 最多可加载的条目
			var maxItems = 100;
			var lastIndex = $('.list-container li').length;

			function addItems(subject, page) {
				var port = domainName + '/apply/class/list';
				var param = {
					token:baseUser.token,
					org_id:baseUser.orguser.org_id,
					planId:planId,
					subjectId:subject||"",
					page:page||1,
					limit:10
				}
				getData(port,param,function(res){
					// 生成新条目的HTML
					var html = '';
					for (var i = 0; i < res.length; i++) {
						html += `<li>
									<div  class="class_basic">
										<div class="class_title">${planData.title}</div>
										<div class="class_info">
											<div>招收学段:3-12岁  名额：15人</div>
											<div>费用：740元/16课时</div>
											<div>开课:2017-09-08  每周五 18:00-20:00/</div>
											<div>上课校区：东马路校区 /教室：406</div>
										</div>
									</div>
									<div class="class_operation">
										<div class="ADD">
											<div class="class-teacher">齐白石</div>
											<div class="class_operation_box">
												<div class="unchange">选择</div>
											</div>
										</div>
									</div>
								</li>`;
					}
					// 添加新条目
					$('.infinite-scroll .list-container').append(html);
				})
				
			}
			addItems(20,0)
			$(page).on('infinite', function () {
				// 如果正在加载，则退出
				if (loading) return;
				// 设置flag
				loading = true;
				// 模拟1s的加载过程
				setTimeout(function () {
					// 重置加载flag
					loading = false;
					if (lastIndex >= maxItems) {
						// 加载完毕，则注销无限加载事件，以防不必要的加载
						$.detachInfiniteScroll($('.infinite-scroll'));
						// 删除加载提示符
						$('.infinite-scroll-preloader').remove();
						return;
					}
					addItems(itemsPerLoad, lastIndex);
					// 更新最后加载的序号
					lastIndex = $('.list-container li').length;
					$.refreshScroller();
				}, 1000);
			});
		});
		$.init()
	})



	// //查看报名须知
	$(document).on('click', '.open-signNotice', function() {
		$.popup('.popup-signNotice');
	});

	// var u = navigator.userAgent, app = navigator.appVersion;   
	// var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端   
	
	// var courseData={};//已选择课程
	// var loacalData="";//本地班级数据
	
	// //本地班级信息
    // var classData={};
    // //已选择暂存
	// var changingData=[]
 
	// var backId=GetUrlParam("id");

	//var certificationState=JSON.parse(sessionStorage.baseUser).isCertification;
	
	// $(function(){
		
	// 	$("#first,#closeFirst").click(function(){
	// 		sessionStorage.first=1;
	// 	})
		
	// 	if(sessionStorage.first==1){
	// 		$("#firstTip").css("display","none")
	// 	}
		
	//    //提交报名
	//    $(document).on('click', '#tool_toDo', function(){
	// 	 var $this=$(this);
		
	// 	  if(certificationState==0){
   	// 		    $.confirm('未实名认证，不可报名', '实名认证', 
   	// 		    		null,
   	// 		    	  function () {
	// 			          window.location="authentication.html"
	// 			        },
   	// 			        "暂时跳过",
   	// 			        "这就去认证" 
   	// 			      );
   	// 		    return false 
	// 		 }else{
	// 			 if($("#timeTip").attr("data-countdown")<0){
	// 					$.alert("报名招生已结束，不能再报名了");
	// 					return false
	// 				}
					
	// 				if( $this.attr("data-open")==0){
	// 					$.alert("报名招生未开启，还不能报名！");
	// 					return false
	// 				}
					
	// 				var changedClass=[];
	// 				$("#allClass .changed").each(function(){
	// 					var id=$(this).closest(".class_operation").attr("id");
	// 					changedClass.push(id);
	// 				});
	// 				var data={
	// 					token:sessionStorage.token,
	// 					userId:JSON.parse(sessionStorage.baseInfo).userId,
	// 					classIds:changedClass.join("|"),
	// 				    trainRecruitId:backId.split("#")[0]
	// 				 };
					
	// 				if(changedClass.length==0){
	// 					 $.alert("至少选择一门课程");
	// 					 return false
	// 				}
	// 				$.showPreloader("排队提交中，请勿返回或关闭页面....");
	// 				getDataShowLoad("../../../api/newStudent/saveNewRegistrationInfo",data,function(result){
	// 					 if(result.code=="0"&&result.success=="true"){
	// 						/* $.alert("报名成功！",function(){
	// 							//window.location.href="pay_list.html"
	// 						 });  */
	// 						 //sessionStorage.signResult=JSON.stringify(result);
	// 						 //window.location.href="sign_result_success.html";
	// 						 var reC=1;
	// 						 var queryR=setInterval(function(){
	// 							 var data={
	// 										token:sessionStorage.token,
	// 										userId:JSON.parse(sessionStorage.baseInfo).userId,
	// 										classIds:changedClass.join("|"),
	// 									    trainRecruitId:backId.split("#")[0],
	// 									    rqCount:reC
	// 									 };
								 
	// 							 getDataShowLoad("../../../api/newStudent/getNewRegistrationResult",data,function(result){
	// 								 reC+=1;
	// 								 if(result.code=="0"&&result.success=="true"){
	// 									 for(var i=result.classList.length-1;i>=0;i--){
	// 										 if(result.classList[i].msg=="成功"||result.classList[i].msg=="已满"||result.classList[i].msg=="已报名"){
	// 											 sessionStorage.signResult=JSON.stringify(result);
	// 											 window.location.href="sign_result_success.html";
	// 											 $.hidePreloader();
	// 											 break
	// 										 }
	// 									 }
	// 								 }else{
	// 									 $.alert(result.msg);
	// 									 clearInterval(queryR);
	// 								 }
	// 							 },"POST","排队提交中，请勿返回或关闭页面....");
								    
	// 						 }, 1000);
							 
	// 					 }else{
	// 						$.hidePreloader();
	// 						$.alert(result.msg);
	// 					 }
	// 				 },"POST","排队提交中，请勿返回或关闭页面....");
	// 		 }
	// 	});

	// 	//点击选择班级
	// 	$("#allClass").on("click", "li .class_operation", function(){
	// 		debugger
	// 		//时间段--判断时间段是否冲突
	// 		var times=$(this).prev().find("span.classDate").text();//上课时间
	// 		var startDate=$(this).prev().find("span.classStartDate").text();//开课日期年月日
			
	// 		var className=$(this).prev().find("div.class_title").text();//班级名称
			
			
	// 		var $this=$(this);
	// 		var obj=$(this).find(".class_operation_box div");
	// 		var id=$(this).closest(".class_operation").attr("id");
	// 		var money=parseInt($(this).closest(".class_operation").attr("data-number"));
	
	// 		 if(certificationState==0){
	//    			    $.confirm('未实名认证，不可报名', '实名认证', 
	//    			    		null,
	//    			    	  function () {
	// 				          window.location="authentication.html"
	// 				        },
	//    				        "暂时跳过",
	//    				        "这就去认证" 
	//    				      );
	//    			    return false
	// 			 }else{  
	// 					if($("#timeTip").attr("data-countdown")<0){
	// 						$.alert("报名招生已结束，不能再报名了");
	// 						return false
	// 					}
	// 					//判断科目是否重复
	// 					var courseid=$this.attr("data-courseId");
				 
	// 					//已选择班级
	// 					if(obj.hasClass("changed")){
	// 						obj.addClass("changing").removeClass("changed").text("选择报名");
	// 						delete courseData[id]
							
	// 					}else if(obj.hasClass("unchange")){
	// 						return false
	// 					}else if(obj.hasClass("success")){
	// 						return false
	// 					}else{
							
	// 		 				//判断科目重复
	// 		 				// if(courseData[courseid]==undefined){
	// 		 					//时间段
	// 								var x=time_to_sec(times.split(" ")[1].split("-")[0]);
	// 								var y=time_to_sec(times.split(" ")[1].split("-")[1]);
											
	// 							    var week=times.split(" ")[0];
								    
	// 								var isF=1;
									
	// 								//判断时间段是否重复
	// 				 			/* 	for(var i in courseData){
	// 				 					//if(i!==courseid){
	// 				 						var a=time_to_sec(courseData[i].times.split(" ")[1].split("-")[0]);
	// 										var b=time_to_sec(courseData[i].times.split(" ")[1].split("-")[1]);
											
	// 										var changedWeek=courseData[i].times.split(" ")[0];
											
	// 										if(week==changedWeek){
	// 											//判断重叠很麻烦··判断不重叠很简单，从不重叠判断
	// 											if(a>y||b<x){
	// 												//如果不存在则添加console.info("不重叠");
	// 												//courseData[courseid]={times:times,name:className};
	// 											}else{
	// 												isF=0;
	// 												$.alert("当前所选"+className+"("+times+")与【"+courseData[i].name+"("+courseData[i].times+")】上课时间冲突！");
	// 												break
	// 											}
	// 										}
											
	// 				 					//} 
	// 				 				} */
									
	// 								//if(isF==1){
	// 									courseData[id]={times:times,name:className,startDate:startDate};
	// 									obj.removeClass("changing").addClass("changed").text("已选择");
	// 								//}
					 				
							
				 				
	// 				 			 var changing=[],num=0;	
	// 				 			 $("#allClass li").each(function(){
	// 				 				var obj=$(this).find(".class_operation_box div");
	// 				 				var id=$(this).find(".class_operation").attr("id");
	// 				 				var money=parseInt($(this).find(".class_operation").attr("data-number"));
					 				 
	// 				 				if(obj.hasClass("changed")){
	// 				 					changing.push(id);//删除id
	// 				 					num=num+money;
	// 				 				}
	// 				 				//选择课程后底部更新选择信息
	// 				 				$("#tool_tipText").text("共"+changing.length+"门课程,合计"+(num>=0?num:0)+"元");
	// 				 			}); 
								
	// 					}
			 			 
	// 		}
	
	// 	});
	// 	/*
	// 	var data={
	// 		token:sessionStorage.token,
	// 		userId:JSON.parse(sessionStorage.baseInfo).userId,
	// 		trainRecruitId:backId.split("#")[0]
	// 		//招生计划表主键
	// 		}*/
	//    //获取班级信息
	//    getData("../../../api/newStudent/queryClassListByTrainRecruitId",data,function(result){
	//    	    loacalData=result.classList;
	// 		if(result.code=="0"){
				
	// 				//招生基本信息
	// 				var sysTime=new Date(GetDateDiff(result.sysTime)).getTime();
	// 				var signInfo=result.busTrainRecruit;
					 
	// 				//报名须知
	// 				$("#shouldKnow").html(signInfo.shouldKnow);
	// 				$("#signTitle").html(signInfo.title);
						
	// 					var openTip="";
	// 					var html="";
	// 					//倒计时提示
	// 					if(signInfo.isOpen=="0"){
	// 						var mss=0;
	// 						var openTip="招生暂未开启，敬请关注！";
	// 						$("#tool_toDo").attr("data-open","0");
	// 						 if(loacalData.length>0){
	// 							   for(var i=loacalData.length-1;i>=0;i--)	{
	// 							        var res= loacalData[i];
	// 							         //判断班级是否报名
	// 								    var changedSign='<div class="unchange">未开启</div>';
	// 								    html += '<li data-categoryId="'+res.categoryId+'">'+
	// 												'<div class="class_basic">'+
	// 												'<div class="class_title" style="">'+res.courseName+"("+res.name+")"+res.termNumber+'期</div>'+
	// 													'<div class="class_info">'+
	// 														'<div>招收学段:'+res.ageRange+'  名额：'+res.classSize+'人</div>'+
	// 											        	'<div>费用：'+res.tuition+'元/'+res.hourNumber+'课时</div>'+
	// 											        	'<div>开课:<span class="classStartDate">'+res.classStartDate+'</span> <span class="classDate">'+res.classDate+' '+res.classTimeStart+"-"+res.classTimeEnd+'</span></div>'+
	// 											        	'<div>上课校区：'+res.campusName+' /教室：'+res.classroom+' </div>'+
	// 													'</div>'+
	// 												'</div>'+
	// 												'<div class="class_operation" id="'+res.id+'"  data-number="'+res.tuition+'"  data-courseId="'+res.courseId+'">'+
	// 													'<div class="ADD">'+
	// 														'<div class="class-teacher">'+res.teacherInfo.split("_")[0]+'</div>'+
	// 														'<div class="class_operation_box" >'+
	// 															//'<div class="unchange">已报名</div>'+
	// 															changedSign+
	// 														'</div>'+
	// 													'</div>'+
	// 												'</div>'+
	// 											'</li>';
	// 							   }
	// 						   }else{
	// 							   html+='<div class="noData noData_line">'+
	// 						           		'<span class="noData__tips">暂无数据</span>'+
	// 						             '</div>';
	// 						   }
	// 						//处理原始树生成JSON格式
	// 						 HandleData(loacalData);
	// 						 $("#allClass").html(html);
	// 						 if(sessionStorage.changingData!==undefined){
	// 							 //如果曾经筛选，择显示上次的筛选结果
	// 							 var lastChanged=JSON.parse(sessionStorage.changingData);
								 
	// 							 if(lastChanged.length>0){
	// 								  	//筛选数据
	// 								   	//categoryId
	// 									changingData=lastChanged;
									  	
	// 								 $("#allClass li").css("display","none");
	// 									//遍历已选数据
	// 									   for(var i=lastChanged.length-1;i>=0;i--){
	// 										   	var category=lastChanged[i].category;
	// 										   	var obj=lastChanged[i].course;
											   	
	// 										   	if(classData[category]==undefined){
	// 										   		changingData.splice(i,1);
	// 										   	}else{
	// 										   	 //更新本地数据
	// 										   	    if(classData[category]["course"][obj]!==undefined){
	// 											   	  classData[category]["course"][obj].isChanged=1;
	// 										   	    }
	// 										   	}
											   	
											   	
	// 										   	$("#allClass li").each(function(){
	// 										   		if($(this).attr("data-categoryid")==category && $(this).find(".class_operation").attr("data-courseid")==obj){
	// 										   			$(this).css("display","flex");
	// 										   		}
	// 										   	});
	// 									   }
	// 								$("#changedCour").text("("+lastChanged.length+")");
	// 							 } 
								 
	// 						 }
							 
							 
	// 					}else{
	// 						var startTime=new Date(GetDateDiff(signInfo.startTime)).getTime();
	// 						var endTime=new Date(GetDateDiff(signInfo.endTime)).getTime();
							
							
	// 						//判断是否满员
	// 						getData("../../../api/newStudent/queryFilledClassIds",{token:sessionStorage.token,da:Math.random()},function(result){
	// 							//是否报满
	// 							if(result.code=="0"){
	// 								//添加报名已满的的状态
	// 								for(var i=result.filledClassIds.length-1;i>=0;i--){
	// 									var nowObj=parseInt(result.filledClassIds[i]);
	// 									for(var m=loacalData.length-1;m>=0;m--){
	// 										var classId=loacalData[m].id;
	// 										if(nowObj==classId){
	// 										    loacalData[m].isFull=1;
	// 										}
	// 									}
	// 								};
									
	// 							   //查询已报名的班级
	// 						       getData("../../../api/newStudent/queryRegisteredClassIds",{token:sessionStorage.token,da:Math.random()},function(result){
	// 									//是否报名
	// 									if(result.code=="0"){
	// 										//添加报名状态
	// 										for(var i=result.registeredClassIds.length-1;i>=0;i--){
	// 											var nowObj=parseInt(result.registeredClassIds[i]);
	// 											for(var m=loacalData.length-1;m>=0;m--){
	// 												var classId=loacalData[m].id;
	// 												if(nowObj==classId){
	// 												    loacalData[m].issign=1;
	// 												}
	// 											}
	// 										};
											
	// 							  //查询白名单
	// 						       getData("../../../api/newStudent/queryWhiteListClassIds",{token:sessionStorage.token,da:Math.random()},function(result){
	// 						    	       //是否报名
	// 										if(result.code=="0"){
	// 											//添加报名状态
	// 											var wClass=result.whiteListClassIds;
	// 											for(var i=wClass.length-1;i>=0;i--){
	// 												var nowObj=parseInt(wClass[i]);
	// 												for(var m=loacalData.length-1;m>=0;m--){
	// 													var classId=loacalData[m].id;
	// 													if(nowObj==classId){
	// 													    loacalData[m].isFull=0;
	// 													}
	// 												}
	// 											};
	// 										   //已报名
	// 											var html="";
	// 											//处理原始树生成JSON格式
	// 											HandleData(loacalData);
												
	// 											if(sysTime < startTime){
	// 												var mss=startTime-sysTime;
	// 												  openTip +="距离报名开始:<span data-end='"+endTime+"' data-sys='"+sysTime+"' class='off'>"+formatDuring(mss)+"</span>";
												
	// 												  //遍历班级信息
													  
	// 												   if(loacalData.length>0){
	// 													   for(var i=loacalData.length-1;i>=0;i--)	{
	// 													        var res= loacalData[i];
	// 													         //判断班级是否报名
	// 														    var changedSign='<div class="unchange">未开启</div>';
	// 														    html += '<li data-categoryId="'+res.categoryId+'">'+
	// 																		'<div class="class_basic">'+
	// 																		'<div class="class_title" style="">'+res.courseName+"("+res.name+")"+res.termNumber+'期</div>'+
	// 																			'<div class="class_info">'+
	// 																				'<div>招收学段:'+res.ageRange+'  名额：'+res.classSize+'人</div>'+
	// 																	        	'<div>费用：'+res.tuition+'元/'+res.hourNumber+'课时</div>'+
	// 																	        	'<div>开课:<span class="classStartDate">'+res.classStartDate+'</span> <span class="classDate">'+res.classDate+' '+res.classTimeStart+"-"+res.classTimeEnd+'</span></div>'+
	// 																	        	'<div>上课校区：'+res.campusName+' /教室：'+res.classroom+' </div>'+
	// 																			'</div>'+
	// 																		'</div>'+
	// 																		'<div class="class_operation" id="'+res.id+'"  data-number="'+res.tuition+'"  data-courseId="'+res.courseId+'">'+
	// 																			'<div class="ADD">'+
	// 																				'<div class="class-teacher">'+res.teacherInfo.split("_")[0]+'</div>'+
	// 																				'<div class="class_operation_box" >'+
	// 																					//'<div class="unchange">已报名</div>'+
	// 																					changedSign+
	// 																				'</div>'+
	// 																			'</div>'+
	// 																		'</div>'+
	// 																	'</li>';
	// 													   }
	// 												   }else{
	// 													   html+='<div class="noData noData_line">'+
	// 												           		'<span class="noData__tips">暂无数据</span>'+
	// 												             '</div>';
	// 												   }
												     
	// 												   $("#tool_toDo").text("未开启").attr("data-open","0");
												
												
	// 											}else{
	// 												var mss=endTime-sysTime;
	// 												if(mss<0){
	// 													  openTip+="报名结束";
	// 													  var text="报名已结束";
	// 													 $("#tool_tipText").text(text);
	// 													 setTimeout(function(){
	// 														 $(".changing").addClass("unchange").text("已结束");
	// 													 },300);
														 
														
	// 												}else{
	// 													 openTip+="距离报名结束:<span class='on'>"+formatDuring(mss)+"</span>";
	// 												}
													
	// 												 //遍历班级信息
	// 												   var html="";
	// 												   if(loacalData.length>0){
	// 													   for(var i=loacalData.length-1;i>=0;i--)	{
	// 													        var res= loacalData[i];
														   
	// 													        	//判断班级是否报满
	// 														       if(res.isFull==1){
	// 														    	   var fullTip='<div class="isfull"></div>';
	// 														       	   var changedSign='<div class="unchange">已满</div>';
	// 														       }else{
	// 														    	   var fullTip='';
	// 														        	var changedSign='<div class="changing">选择报名</div>';
	// 														        }
	// 														        //判断是否报名
	// 														        if(res.issign==1){
															        	
	// 														        	var changedSign='<div class="success">已报名</div>';
	// 														        	courseData[res.id]={times:res.classDate+" "+res.classTimeStart+"-"+res.classTimeEnd,name:res.name,startDate:res.classStartDate};
	// 														        }
														   
	// 														    html += '<li data-categoryId="'+res.categoryId+'">'+fullTip+
	// 																		'<div class="class_basic">'+
	// 																			'<div class="class_title" style="">'+res.courseName+"("+res.name+")"+res.termNumber+'期</div>'+
	// 																			'<div class="class_info">'+
	// 																				'<div>招收学段:'+res.ageRange+'  名额：'+res.classSize+'人</div>'+
	// 																	        	'<div>费用：'+res.tuition+'元/'+res.hourNumber+'课时</div>'+
	// 																	        	'<div>开课:<span class="classStartDate">'+res.classStartDate+'</span> <span class="classDate">'+res.classDate+' '+res.classTimeStart+"-"+res.classTimeEnd+'</span></div>'+
	// 																	        	'<div>上课校区：'+res.campusName+' /教室：'+res.classroom+' </div>'+
	// 																			'</div>'+
	// 																		'</div>'+
	// 																		'<div class="class_operation" id="'+res.id+'"  data-number="'+res.tuition+'"  data-courseId="'+res.courseId+'">'+
	// 																			'<div class="ADD">'+
	// 																				'<div class="class-teacher">'+res.teacherInfo.split("_")[0]+'</div>'+
	// 																				'<div class="class_operation_box" >'+
	// 																					//'<div class="unchange">已报名</div>'+
	// 																					changedSign+
	// 																				'</div>'+
	// 																			'</div>'+
	// 																		'</div>'+
	// 																	'</li>';
	// 													   }
	// 												   }else{
	// 													   html+='<div class="noData noData_line">'+
	// 												           		'<span class="noData__tips">暂无数据</span>'+
	// 												             '</div>';
	// 												   }
	// 											}
												
	// 											$("#allClass").html(html);
												
	// 											$("#timeTip").html(openTip);
	// 											$("#timeTip").attr("data-countdown",mss)
	// 											//更新倒计时
	// 											 var dd=setInterval(function(){
	// 											    	var timeM=parseInt($("#timeTip").attr("data-countdown"))-1000;
	// 											    	if(timeM>=-1000){
	// 											    		$("#timeTip").attr("data-countdown",timeM);
	// 												        if(timeM==-1000){
	// 												        	if($("#timeTip span").hasClass("on")){
	// 												    			//$.router.loadPage("sign_list.html");
	// 												    			$.alert("报名结束",function(){ 
	// 												    				window.location="sign_list.html";
	// 												    			})
													    			
	// 												    		}else{
	// 												    		/* 	var mss=endTime-sysTime;
	// 												    			$("#timeTip").attr("data-countdown",mss);
	// 																var openTip="距离报名结束:<span class='on'>"+formatDuring(mss)+"</span>";
	// 																$("#timeTip").find("span").html(openTip); */
	// 																window.location.reload();
	// 												    		}
	// 												        }else{
	// 												        	$("#timeTip").find("span").html(formatDuring(timeM));
	// 												        }
	// 											    	}else{
	// 											    		//window.location="sign_list.html";
	// 											    	}
													    
	// 											 }, 1000);
												
	// 											 if(sessionStorage.changingData!==undefined){
	// 												 //如果曾经筛选，择显示上次的筛选结果
	// 												 var lastChanged=JSON.parse(sessionStorage.changingData);
													 
	// 												 if(lastChanged.length>0){
	// 													  	//筛选数据
	// 													   	//categoryId
	// 														changingData=lastChanged;
														  	
	// 													 $("#allClass li").css("display","none");
	// 														//遍历已选数据
	// 														   for(var i=lastChanged.length-1;i>=0;i--){
	// 															   	var category=lastChanged[i].category;
	// 															   	var obj=lastChanged[i].course;
																   	
	// 															   	if(classData[category]==undefined){
	// 															   		changingData.splice(i,1);
	// 															   	}else{
	// 															   	 //更新本地数据
	// 															   	    if(classData[category]["course"][obj]!==undefined){
	// 																   	  classData[category]["course"][obj].isChanged=1;
	// 															   	    }
	// 															   	}
																   	
																   	
	// 															   	$("#allClass li").each(function(){
	// 															   		if($(this).attr("data-categoryid")==category && $(this).find(".class_operation").attr("data-courseid")==obj){
	// 															   			$(this).css("display","flex");
	// 															   		}
	// 															   	});
	// 														   }
	// 													$("#changedCour").text("("+lastChanged.length+")");
	// 												 } 
													 
	// 											 }
												
												
	// 											 if(certificationState==0){
	// 													$("#toFilterTip").hide();
	// 													$("#categoryId div").css("width","92%");
	// 													setTimeout(function(){
	// 														 $.confirm('未实名认证，不可报名', '实名认证', 
	// 												    		null,
	// 												    	  function () {
	// 													          window.location="authentication.html"
	// 													        },
	// 													        "暂时跳过",
	// 													        "这就去认证" 
	// 													      ); 
	// 													},300)
	// 												  } 
												
												
	// 										}else{
	// 											 $.alert(result.msg);
	// 										}
	// 									});
										
				
	// 								}else{
	// 									 $.alert(result.msg);
	// 								}
	// 							    //查询白名单		
	// 						       });		
											
											
	// 							}else{
	// 								 $.alert(result.msg);
	// 							}
	// 						});
						
	// 					}
	// 					$("#timeTip").html(openTip);
	// 					//报名须知 */
	// 				    /* var base=result.busTrainRecruit
					 
	// 					var start=new Date(GetDateDiff(base.startTime)).getTime(),
	// 					      end=new Date(GetDateDiff(base.endTime)).getTime(),
	// 					      title=base.title,
	// 					      shouldKnow=base.shouldKnow; *///报名须知 
				
	// 		}else{
	// 			 $.alert(result.msg);
	// 		}
	//    });
	
		
	// });
	
	
	//打开筛选页面--
	// $("#categoryId").click(function(){
		
	// 	$("#allCategory ul li.active").removeClass("active");
		
	// 	//遍历数据统计个数
	// 	for(var i in classData){
	// 		var nowCount=0
	// 	  for(var m in classData[i]["course"]){
	// 	       if(classData[i]["course"][m]["isChanged"]=="1"){
	// 	        nowCount+=1;
	// 	      }
	// 	  };
	// 	 $("#categoryId"+i+" span" ).text(nowCount);
	//     }
		
	// 	$.router.loadPage("#password");
		
	// 	setTimeout(function(){
	// 		var categoryId=$("#allCategory ul li").eq(0).attr("value");
	// 		var html="";
			
	// 		$("#allCategory ul li").eq(0).click();
	// 		$("#allCategory ul li").eq(0).addClass("active");
			 
			
	// 		for(var i in classData[categoryId]["course"]){
	// 			var obj=classData[categoryId]["course"][i]["courseName"];
	// 			if(classData[categoryId]["course"][i].isChanged=="1"){
	// 				var checked="checked='checked'";
	// 			}else{
	// 				var checked="";
	// 			}
				
	// 		  html += '<li value="'+i+'">'+
	// 				          '<label class="label-checkbox item-content">'+
	// 				            '<div class="clickObj"></div>'+
	// 				            '<input type="checkbox" name="my-radio" data-value="'+i+'" '+checked+' >'+
	// 				            '<div class="item-media"><i class="icon icon-form-checkbox"></i></div>'+
	// 				            '<div class="item-inner">'+
	// 				              '<div class="item-title-row">'+
	// 				                '<div class="item-title">'+obj+'</div>'+
	// 				              '</div>'+
	// 				            '</div>'+
	// 				          '</label>'+
	// 				       ' </li>';
	// 		}
			
	// 		$("#allCourse ul").html(html);
			
	// 		},100);
		
	// });
	

	//点击类目加载对应科目--筛选操作
	// $("#allCategory").on("click","li",function(){
	// 	//遍历
	// 	/* $("#allCourse input:checked").each(function(){
	// 		var courseId=$(this).attr("data-value");
	// 		changingData.push(courseId);
	// 	}); */
		
	// 	$("#allCategory ul li.active").removeClass("active");
	// 	$(this).addClass("active");
	// 	var categoryId=$(this).val();
	// 	var html="";
		
	// 	for(var i in classData[categoryId]["course"]){
			
	// 		var obj=classData[categoryId]["course"][i]["courseName"];
	// 		if(classData[categoryId]["course"][i].isChanged=="1"){
	// 			var checked="checked='checked'";
	// 		}else{
	// 			var checked="";
	// 		}
			
	// 		if(changingData.length>0){
	// 			for(var n=changingData.length-1;n>=0;n--){
	// 				//var changingcategoryid=changingData[n].category;
	// 				var changingcourseid=changingData[n].course;
	// 				if(changingcourseid==i){
	// 					var checked="checked='checked'";
	// 				}
	// 			}
	// 		}
			
	// 	  html += '<li value="'+i+'" >'+
	// 			          '<label class="label-checkbox item-content">'+
	// 			            '<div class="clickObj"></div>'+
	// 			            '<input type="checkbox" name="my-radio" data-value="'+i+'" '+checked+' >'+
	// 			            '<div class="item-media"><i class="icon icon-form-checkbox"></i></div>'+
	// 			            '<div class="item-inner">'+
	// 			              '<div class="item-title-row">'+
	// 			                '<div class="item-title">'+obj+'</div>'+
	// 			              '</div>'+
	// 			            '</div>'+
	// 			          '</label>'+
	// 			       ' </li>';
	// 	}
	// 	$("#allCourse ul").html(html);
	// });
	
	// //清除上次所选
	// $("#clearBtn").click(function(){
	// 	$("#allCourse input").prop("checked",false);
	// 	clearChanged();
	// })
	
	// //$("body").on("touchmove",function(event){
	// $("#allCourse").on("touchmove","li",function(event){
	// 	return false
	// })

/* 	var content=document.getElementById("allCourse");
    var items=content.getElementsByTagName("li");
    items.addEventListener('touchmove', function(event) {
   　　　　 event.preventDefault();// 阻止浏览器默认事件，重要 
        return false
   }, false); */
 

	
	//选择添加到本地数据存储
// 	$("#allCourse").on("click","li",function(e){
// 		var obj=$(this).attr("value");
// 		var parent=$("#allCategory ul li.active").attr("value");
		
// 		if(isiOS){//ios
// 			if(!$(this).find("input").is(":checked")){
// 				changingData.push({course:obj,category:parent});//科目，类目便于查询
// 				var cou=0;
// 				for(var i=0;i<changingData.length;i++){
// 					if(changingData[i].category==parent){
// 						cou+=1;
// 					}
// 				}
// 				$("#categoryId"+parent+" span").html(cou);
				
// 			}else{

// 				var nowObj={course:obj,category:parent};
				
// 				//已选择中清除
// 				for(var m=changingData.length-1;m>=0;m--){
// 					if(isEqual(nowObj,changingData[m])){
// 						changingData.splice(m,1);
// 					}
// 				}
// 				var cou=0;
// 				for(var i=0;i<changingData.length;i++){
// 					if(changingData[i].category==parent){
// 						cou+=1;
// 					}
// 				}
			 
// 				$("#categoryId"+parent+" span").html(cou);
// 			}
			
// 		}else{//安卓
// 				if($(this).find("input").is(":checked")){
// 					changingData.push({course:obj,category:parent});//科目，类目便于查询
// 					$("#categoryId"+parent+" span").html($("#allCourse li input:checked").length);	
// 				}else{
// 					var nowObj={course:obj,category:parent};
// 					//已选择中清除
// 					for(var m=changingData.length-1;m>=0;m--){
// 						if(isEqual(nowObj,changingData[m])){
// 							changingData.splice(m,1);
// 						}
// 					}
// 					$("#categoryId"+parent+" span").html($("#allCourse li input:checked").length);
// 				}
// 		}

// 	});
	
// 	//保存所选
// 	$("#saveChanged").click(function(){
// 		for(var i in classData){
// 			var nowCount=0
// 		  for(var m in classData[i]["course"]){
// 		       if(classData[i]["course"][m]["isChanged"]=="1"){
// 		    	   delete classData[i]["course"][m]["isChanged"];
// 		      }
// 		  };
// 	    }
 
// 		if(changingData.length==0){
// 			$("#allClass li").css("display","flex");
// 		}else{
// 			//筛选显示结果
// 			$("#allClass li").css("display","none");
// 			//遍历已选数据
// 		    for(var i=changingData.length-1;i>=0;i--){
// 		    	var category=changingData[i].category;
// 		    	var obj=changingData[i].course;
// 		    	//更新本地数据
// 		    	classData[category]["course"][obj].isChanged=1;
// 		    	//筛选数据
// 		    	//categoryId
		    	
// 		    	$("#allClass li").each(function(){
// 		    		if($(this).attr("data-categoryid")==category && $(this).find(".class_operation").attr("data-courseid")==obj){
// 		    			$(this).css("display","flex");
// 		    		}
// 		    	});
// 		    }
// 		}
		
// 		//筛选结果保存到本地---辛伟后提
// 	    sessionStorage.changingData=JSON.stringify(changingData);
// 		//返回报名列表页面
// 		//$.router.back("sign_class_list_new.html");
// 		window.location="sign_class_list_new.html?id="+backId.split("#")[0];
// 		 $("#changedCour").text("("+JSON.parse(sessionStorage.changingData).length+")");
// 	});
	
// 	$("#back").click(function(){
// 		window.location="sign_class_list_new.html?id="+backId.split("#")[0];
// 	})

	
	
// function HandleData(dealData){
// 	for(var i=dealData.length-1;i>=0;i--){
//          var obj=dealData[i];
         
//          //不存在
//          if(classData[obj.categoryId]==undefined){
         	
//          classData[obj.categoryId]={};
// 		 classData[obj.categoryId]["categoryName"]=obj.categoryName;//类目名称
// 		 classData[obj.categoryId]["course"]={}//科目信息
		 
// 		 //更新到筛选工具
// 		 $("#allCategory ul").append("<li value='"+obj.categoryId+"' id='categoryId"+obj.categoryId+"' class='item-link list-button' >"+obj.categoryName+"(<span>0</span>)</li>");
		 
// 		 //科目信息
// 		 classData[obj.categoryId]["course"][obj.courseId]={};
// 		 classData[obj.categoryId]["course"][obj.courseId]["courseName"]=obj.courseName; 
// 		 classData[obj.categoryId]["course"][obj.courseId]["classes"]={}; 

// 		 //班级信息
// 		 classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]= {};
//          classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["name"]=obj.name;

// 		 classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["ageRange"]=obj.ageRange;
//          classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["campusName"]=obj.campusName;
//          classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classDate"]=obj.classDate, 
//          classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classSize"]=obj.classSize, 
//          classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classStartDate"]=obj.classStartDate; 
//          classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classTimeStart"]=obj.classTimeEnd;
//          classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["courseName"]=obj.classTimeStart;
//          classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classroom"]=obj.classroom;
//          classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["hourNumber"]=obj.hourNumber;
//          classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["teacherInfo"]=obj.teacherInfo;
//          classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["termNumber"]=obj.termNumber;
//          classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["tuition"]=obj.tuition;
         	
//          }else{
//          	//同类目
//          	//判断科目
//          	if(classData[obj.categoryId]["course"][obj.courseId]==undefined){
//          		 //科目信息
// 				 classData[obj.categoryId]["course"][obj.courseId]={};
// 				 classData[obj.categoryId]["course"][obj.courseId]["courseName"]=obj.courseName; 
// 				 classData[obj.categoryId]["course"][obj.courseId]["classes"]={}; 
// 				 //班级信息
// 				 classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]= {};
// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["name"]=obj.name;

// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["ageRange"]=obj.ageRange;
// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["campusName"]=obj.campusName;
// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classDate"]=obj.classDate, 
// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classSize"]=obj.classSize, 
// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classStartDate"]=obj.classStartDate; 
// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classTimeStart"]=obj.classTimeEnd;
// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["courseName"]=obj.classTimeStart;
// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classroom"]=obj.classroom;
// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["hourNumber"]=obj.hourNumber;
// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["teacherInfo"]=obj.teacherInfo;
// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["termNumber"]=obj.termNumber;
// 		         classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["tuition"]=obj.tuition;
//          	}else{
//          		if(classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]==undefined){
//          			classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]= {};
// 			        classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["name"]=obj.name;
					 
// 					classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["ageRange"]=obj.ageRange;
// 			        classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["campusName"]=obj.campusName;
// 			        classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classDate"]=obj.classDate, 
// 			        classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classSize"]=obj.classSize, 
// 			        classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classStartDate"]=obj.classStartDate; 
// 			        classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classTimeStart"]=obj.classTimeEnd;
// 			        classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["courseName"]=obj.classTimeStart;
// 			        classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["classroom"]=obj.classroom;
// 			        classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["hourNumber"]=obj.hourNumber;
// 			        classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["teacherInfo"]=obj.teacherInfo;
// 			        classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["termNumber"]=obj.termNumber;
// 			        classData[obj.categoryId]["course"][obj.courseId]["classes"][obj.id]["tuition"]=obj.tuition;
//          		} 
//          	}
         	
//          }
// 	} 
// };

// //重置操作
// function clearChanged(){
// 	//筛选结果保存到本地---辛伟后提
//     changingData=[];
// 	for(var i in classData){
// 		  for(var m in classData[i]["course"]){
// 		       if(classData[i]["course"][m]["isChanged"]=="1"){
// 		        delete classData[i]["course"][m]["isChanged"];
// 		      }
// 		  }
// 	}
// 	//重置计数
// 	$("#changedCour").text("(0)");
// 	$("#allCategory span").text("0");
// }
</script>